@using GoodianoBlog.Application.Services.Posts.Query.Admin.Comments.GetAllComments
@model List<GetAllCommentDto>
@{
    ViewData["Title"] = "Index";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<div class="content-wrapper">
    <div class="container-fluid">
        <!-- Zero configuration table -->
        <section id="configuration">

            <div class="row">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title-wrap bar-success">
                                <h4 class="card-title">لیست کامنت ها</h4>
                            </div>
                        </div>
                        <div class="card-body collapse show">
                            <div class="card-dashboard">
                                <div id="DataTables_Table_0_wrapper" class="dataTables_wrapper container-fluid dt-bootstrap4">
                                    <div class="col-sm-12">
                                        <table class="table table-striped table-bordered zero-configuration dataTable" id="DataTables_Table_0" role="grid" aria-describedby="DataTables_Table_0_info">
                                            <thead>
                                                <tr role="row">
                                                    <th class="sorting_asc" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-sort="ascending" aria-label="نام: activate to sort column descending" style="width: 150px;">نام کاربری</th>
                                                    <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="ایمیل: activate to sort column ascending" style="width: 150px;">ایمیل</th>
                                                    <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="ایمیل: activate to sort column ascending" style="width: 100px;">تیتر پست</th>
                                                    <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="ایمیل: activate to sort column ascending" style="width: 150px;">کامنت</th>
                                                    <th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" aria-label="ایمیل: activate to sort column ascending" style="width: 100px;">وضعیت تایید</th>
                                                </tr>
                                            </thead>
                                            <tbody>

                                                @foreach (var item in Model)
                                                {
                                                    <tr role="row" class="odd">
                                                        <td class="sorting_1">@item.UserName</td>
                                                        <td>@item.Email</td>
                                                        <td>@item.PostTitle</td>
                                                        <td>@item.Context</td>
                                                        <td>
                                                            @if (!item.IsConfirm)
                                                            {
                                                                <button class="btn btn-warning" onclick="CommentSatusChange('@item.Id')">منتشر نشده</button>

                                                            }
                                                            else
                                                            {
                                                                <button class="btn btn-success" onclick="CommentSatusChange('@item.Id')">منتشر شده</button>
                                                            }
                                                        </td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

        </section>
    </div>
</div>


@section Scripts
{

<link href="~/Sweetalert2/sweetalert2.min.css" rel="stylesheet" />
<script src="~/Sweetalert2/sweetalert2.min.js"></script>

<script>
    function CommentSatusChange(Id) {
               swal.fire({
                   title: 'تغییر وضعیت انتشار کامنت',
                   text: "از تغییر وضعیت کامنت مطمئن هستید؟",
                   icon: 'warning',
                   showCancelButton: true,
                   confirmButtonColor: '#d33',
                   cancelButtonColor: '#7cacbe',
                   confirmButtonText: 'بله',
                   cancelButtonText: 'خیر'
               }).then((result) => {
                   if (result.value) {

                       var postData = {
                           'Id': Id,
                       };

                       $.ajax({
                           contentType: 'application/x-www-form-urlencoded',
                           dataType: 'json',
                           type: "POST",
                           url: "CommentSatusChange",
                           data: postData,
                           success: function (data) {
                               if (data.isSuccess == true) {
                                   swal.fire(
                                       'موفق!',
                                       data.message,
                                       'success'
                                   ).then(function (isConfirm) {
                                       location.reload();
                                   });
                               }
                               else {

                                   swal.fire(
                                       'هشدار!',
                                       data.message,
                                       'warning'
                                   );

                               }
                           },
                           error: function (request, status, error) {
                               alert(request.responseText);
                           }

                       });

                   }
               })
           }
</script>
}
